<?xml version="1.0" encoding="UTF-8"?>
<featuremetamodel:rootFeature
    xmi:version="2.0"
    xmlns:xmi="http://www.omg.org/XMI"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:featuremetamodel="http://www.vu.nl/featuremetamodel"
    xsi:schemaLocation="http://www.vu.nl/featuremetamodel featuremetamodel.ecore"
    name="ICSRouter"
    description="Root Feature ICSRouter">
  <subFeature
      name="CorporateFirewall"
      baseFeaure="ICSRouter">
    <subFeature
        name="CorporateDemilitarizedZones"
        baseFeaure="CorporateFirewall">
      <subFeature
          name="CorporateAuthenticationServer"
          baseFeaure="CorporateDemilitarizedZones"/>
      <subFeature
          name="CorporateWebServer"
          baseFeaure="CorporateDemilitarizedZones"
          assumption=""
          refFeature="CorporateAuthenticationServer"/>
      <subFeature
          name="CorporateFTPServer"
          featureType="Or"
          baseFeaure="CorporateDemilitarizedZones"
          refGuard="guard_CFTP"
          refFeature="CorporateAuthenticationServer"
          guardCondition="true"/>
      <subFeature
          name="CorporateEmailServer"
          featureType="Or"
          baseFeaure="CorporateDemilitarizedZones"
          refGuard="guard_CE"
          refFeature="CorporateFTPServer"
          guardCondition="true"/>
    </subFeature>
    <subFeature
        name="EnterpriseDemilitarizedZones"
        baseFeaure="CorporateFirewall">
      <subFeature
          name="BusinessServer"
          baseFeaure="EnterpriseDemilitarizedZones"
          refFeature="CorporateAuthenticationServer"/>
      <subFeature
          name="EnterpriseDesktop"
          featureType="Or"
          baseFeaure="EnterpriseDemilitarizedZones"
          refGuard="guard_ED"
          refFeature="BusinessServer"
          guardCondition="true"/>
      <subFeature
          name="EnterpriseWebApplicationServer"
          featureType="Optional"
          baseFeaure="EnterpriseDemilitarizedZones"
          refGuard="guard_EWS"
          refFeature="CorporateAuthenticationServer"
          guardCondition="true"/>
      <subFeature
          name="EnterpriseDomainServer"
          featureType="Or"
          baseFeaure="EnterpriseDemilitarizedZones"
          refGuard="guard_EDS"
          refFeature="EnterpriseWebApplicationServer"
          guardCondition="true"/>
    </subFeature>
  </subFeature>
  <subFeature
      name="ControlCenterFirewall"
      baseFeaure="ICSRouter">
    <subFeature
        name="ControlCenterWorkstation"
        baseFeaure="ControlCenterDemilitarizedZones"
        refGuard="guard_CCW"
        refFeature="CorporateAuthenticationServer"
        guardCondition="true"/>
    <subFeature
        name="ControlCenterAV"
        featureType="Optional"
        baseFeaure="ControlCenterDemilitarizedZones"
        refGuard="guard_CCAV"
        guardCondition="true"/>
    <subFeature
        name="ControlCenterHistorian"
        featureType="Or"
        baseFeaure="ControlCenterDemilitarizedZones"
        refGuard="guard_CCH"
        guardCondition="true"/>
    <subFeature
        name="ControlCenterPatchServer"
        featureType="Or"
        baseFeaure="ControlCenterDemilitarizedZones"
        refGuard="guard_CCPS"
        guardCondition="true"/>
    <subFeature
        name="ControlCenterRemoteAcess"
        baseFeaure="ControlCenterDemilitarizedZones"
        refGuard="guard_CCRA"
        guardCondition="true"/>
    <subFeature
        name="ControlCenterJumpServer"
        featureType="Or"
        baseFeaure="ControlCenterDemilitarizedZones"
        refGuard="!guard_CCRA"
        guardCondition="true"/>
  </subFeature>
  <subFeature
      name="ManufacturingZoneFireWall"
      baseFeaure="ICSRouter">
    <subFeature
        name="ManufacturingZoneDomainController"
        baseFeaure="ManufacturingZoneDemilitarizedZones"/>
    <subFeature
        name="ManufacturingZoneConfigurationServer"
        baseFeaure="ManufacturingZoneDemilitarizedZones"/>
    <subFeature
        name="ManufacturingZoneHistorian"
        featureType="Alternative"
        baseFeaure="ManufacturingZoneDemilitarizedZones"
        refGuard="guard_MZH"
        guardCondition="true"/>
    <subFeature
        name="ManufacturingZoneHMIComputers"
        featureType="Alternative"
        baseFeaure="ManufacturingZoneDemilitarizedZones"
        refGuard="guard_MZHMIC"
        refFeature="ControlerLAN2 &amp; ControlerLAN1"
        guardCondition="true"/>
    <subFeature
        name="ManufacturingZoneDatabaseServer"
        baseFeaure="ManufacturingZoneDemilitarizedZones"
        refGuard="guard_MZDBS"
        refFeature="CorporateAuthenticationServer"
        guardCondition="true"/>
    <subFeature
        name="ManufacturingZoneEngineeringWorkstations"
        baseFeaure="ManufacturingZoneDemilitarizedZones"
        refGuard="guard_MZEWS"
        refFeature="CorporateAuthenticationServer"/>
    <subFeature
        name="LocalHMILAN1"
        baseFeaure="ManufacturingZoneDemilitarizedZones">
      <subFeature
          name="ControlerLAN1"
          baseFeaure="LocalHMILAN1"
          refFeature="CorporateAuthenticationServer">
        <subFeature
            name="FiledDeviceC1"
            featureType="Or"
            baseFeaure="ControlerLAN1"
            refGuard="guard_FDC1"
            refFeature="ControlCenterPatchServer"/>
        <subFeature
            name="SensorC1"
            featureType="Or"
            baseFeaure="ControlerLAN1"
            refGuard="guard_SC1"
            guardCondition="true"/>
        <subFeature
            name="ActuatorC1"
            featureType="Or"
            baseFeaure="ControlerLAN1"
            refGuard="guard_AC1"
            refFeature=""
            guardCondition="true"/>
        <subFeature
            name="LocalHMI1"
            featureType="Or"
            baseFeaure="ControlerLAN1"
            refGuard="guard_LHMI1"
            guardCondition="true">
          <subFeature
              name="FiledDeviceL1"
              baseFeaure="LocalHMI1"
              refGuard="guard_FDL1"
              guardCondition="true"/>
          <subFeature
              name="SensorL1"
              featureType="Or"
              baseFeaure="LocalHMI1"
              refGuard="guard_SL1"
              guardCondition="true"/>
          <subFeature
              name="ActuatorL1"
              featureType="Or"
              baseFeaure="LocalHMI1"
              refGuard="guard_AL1"/>
        </subFeature>
      </subFeature>
    </subFeature>
    <subFeature
        name="LocalHMILAN2"
        baseFeaure="ManufacturingZoneDemilitarizedZones">
      <subFeature
          name="ControlerLAN2"
          baseFeaure="LocalHMILAN2"
          refFeature="CorporateAuthenticationServer">
        <subFeature
            name="FiledDeviceC2"
            featureType="Or"
            baseFeaure="ControlerLAN2"
            refGuard="guard_FD2"
            refFeature="ControlCenterPatchServer"/>
        <subFeature
            name="SensorC2"
            featureType="Or"
            baseFeaure="ControlerLAN2"
            refGuard="guard_SC2"
            guardCondition="true"/>
        <subFeature
            name="ActuatorC2"
            featureType="Or"
            baseFeaure="ControlerLAN2"
            refGuard="guard_AC2"
            refFeature=""
            guardCondition="true"/>
        <subFeature
            name="LocalHMI2"
            featureType="Or"
            baseFeaure="ControlerLAN2"
            refGuard="guard_LHMI2"
            guardCondition="true">
          <subFeature
              name="FiledDeviceL2"
              featureType="Or"
              baseFeaure="LocalHMI2"
              refGuard="guard_FDL2"
              guardCondition="true"/>
          <subFeature
              name="SensorL2"
              featureType="Or"
              baseFeaure="LocalHMI2"
              refGuard="guard_SL2"
              guardCondition="true"/>
          <subFeature
              name="ActuatorL2"
              featureType="Or"
              baseFeaure="LocalHMI2"
              refGuard="guard_AL2"/>
        </subFeature>
      </subFeature>
    </subFeature>
  </subFeature>
</featuremetamodel:rootFeature>
